<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no, interactive-widget=resizes-content">
	<title>N-Body Simulation</title>
	
	<link rel="manifest" href="manifest.json">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="theme-color" content="#1c1c1e">
	
	<meta name="description" content="A real-time interactive N-Body physics simulation. Explore gravity, electromagnetism, and orbital mechanics with customizable bodies and fields directly in your browser.">
	<meta name="keywords" content="N-Body, Physics Simulation, Gravity, Orbital Mechanics, Astronomy, JavaScript, Canvas, Interactive, Science, Education, Electromagnetism">
	<meta name="author" content="Wartets">
	<meta name="robots" content="index, follow">

	<meta property="og:site_name" content="N-Body Simulation">
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://wartets.github.io/N-Body-Simulation/">
	<meta property="og:title" content="N-Body Simulation">
	<meta property="og:description" content="Simulate complex gravitational and electromagnetic interactions in real-time. Create solar systems, galaxies, or particle experiments.">
	<meta property="og:image" content="https://wartets.github.io/N-Body-Simulation/app-icon.jpg">
	<meta property="og:image:width" content="1200">
	<meta property="og:image:height" content="630">

	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:url" content="https://wartets.github.io/N-Body-Simulation/">
	<meta name="twitter:title" content="N-Body Simulation">
	<meta name="twitter:description" content="Simulate complex gravitational and electromagnetic interactions in real-time. Create solar systems, galaxies, or particle experiments.">
	<meta name="twitter:image" content="https://wartets.github.io/N-Body-Simulation/app-icon.jpg">

	<link rel="icon" href="https://wartets.github.io/N-Body-Problem/image/browser-icon.png">
	<link rel="apple-touch-icon" href="https://wartets.github.io/N-Body-Problem/image/browser-icon.png">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<link rel="stylesheet" href="style.css">
</head>
<body>
	<canvas id="simCanvas"></canvas>
	
	<div id="controlPanel">
		<div id="panelHeader">
			<span class="app-title"><i class="fa-solid fa-sliders"></i> Parameters</span>
			<button id="togglePanelBtn"><i class="fa-solid fa-minus"></i></button>
		</div>
		
		<div id="panelContent">
			
			<div class="control-section">
				<div class="section-header">Simulation control</div>
				<div class="btn-group">
					<button id="playPauseBtn" class="btn primary">
						<i class="fa-solid fa-pause"></i> Pause
					</button>
					<button id="resetBtn" class="btn danger">
						<i class="fa-solid fa-rotate-right"></i> Reset
					</button>
				</div>
				<div class="control-row" style="margin-top: 8px;">
					<label>Time step dt <i class="fa-solid fa-circle-question help-icon" data-tooltip="Simulation time step. Higher values speed up simulation but may reduce accuracy."></i></label>
					<span id="dtVal" class="value-display"></span>
				</div>
				<input type="range" id="dtSlider" min="0" max="1000" step="1">
				
				<div class="divider-sub"></div>
				<div class="section-header" style="margin-top: 8px;">Interactions</div>
				
				<label class="toggle-row">
					<span>Gravity <i class="fa-solid fa-circle-question help-icon" data-tooltip="Enables gravitational attraction between massive bodies."></i></span>
					<input type="checkbox" id="gravBox" checked>
					<div class="toggle-switch"></div>
				</label>
				<label class="toggle-row" style="margin-top:4px;">
					<span>Electricity <i class="fa-solid fa-circle-question help-icon" data-tooltip="Enables attraction/repulsion forces between charged bodies."></i></span>
					<input type="checkbox" id="elecBox">
					<div class="toggle-switch"></div>
				</label>
				<label class="toggle-row" style="margin-top:4px;">
					<span>Magnetism <i class="fa-solid fa-circle-question help-icon" data-tooltip="Enables magnetic forces based on body magnetic moments."></i></span>
					<input type="checkbox" id="magBox">
					<div class="toggle-switch"></div>
				</label>
				<label class="toggle-row" style="margin-top:4px;">
					<span>Collisions <i class="fa-solid fa-circle-question help-icon" data-tooltip="Enables detection and resolution of physical collisions between bodies."></i></span>
					<input type="checkbox" id="colBox">
					<div class="toggle-switch"></div>
				</label>
			</div>

			<div class="divider"></div>

			<div class="control-section" id="displaySection">
				<div class="section-header toggle-header">
					<span>Display parameters</span>
					<button id="toggleDisplayBtn" class="btn-icon"><i class="fa-solid fa-chevron-left"></i></button>
				</div>
				
				<div id="displayContent" class="hidden-content">
					<label class="toggle-row">
						<span>Tracking Barycentre <i class="fa-solid fa-circle-question help-icon" data-tooltip="Camera automatically tracks the system's center of mass."></i></span>
						<input type="checkbox" id="camTrackingBox">
						<div class="toggle-switch"></div>
					</label>
					<label class="toggle-row" style="margin-top:8px;">
						<span>Auto Zoom <i class="fa-solid fa-circle-question help-icon" data-tooltip="Camera zooms automatically to keep all bodies visible."></i></span>
						<input type="checkbox" id="camAutoZoomBox">
						<div class="toggle-switch"></div>
					</label>

					<div class="divider-sub"></div>

					<label class="toggle-row">
						<span>Show Trails <i class="fa-solid fa-circle-question help-icon" data-tooltip="Displays the recent trajectory of each body."></i></span>
						<input type="checkbox" id="showTrailsBox" checked>
						<div class="toggle-switch"></div>
					</label>

					<div class="control-row" style="margin-top: 8px;">
						<label>Trail Length <i class="fa-solid fa-circle-question help-icon" data-tooltip="Number of points in each body's trail."></i></label>
						<span id="trailLenVal" class="value-display"></span>
					</div>
					<input type="range" id="trailLenSlider" min="10" max="500" step="10">

					<div class="control-row" style="margin-top: 4px;">
						<label>Trail Skip (Precision) <i class="fa-solid fa-circle-question help-icon" data-tooltip="Trail point recording frequency. Lower values are more precise."></i></label>
						<span id="trailPrecVal" class="value-display"></span>
					</div>
					<input type="range" id="trailPrecSlider" min="1" max="10" step="1">
					
					<div class="control-row" style="margin-top: 4px;">
						<label>Prediction Length <i class="fa-solid fa-circle-question help-icon" data-tooltip="Length of the predicted future trajectory for the selected body."></i></label>
						<span id="predictionLenVal" class="value-display"></span>
					</div>
					<input type="range" id="predictionLenSlider" min="0" max="70000" step="100">
					
					<div class="divider-sub"></div>

					<div class="section-header" style="margin-top: 8px;">Field Visualization</div>
					
					<label class="toggle-row">
						<span>Show Gravity Field (g) <i class="fa-solid fa-circle-question help-icon" data-tooltip="Visualizes the gravitational field generated by bodies."></i></span>
						<input type="checkbox" id="showGravFieldBox">
						<div class="toggle-switch"></div>
					</label>
					<label class="toggle-row" style="margin-top:4px;">
						<span>Show Electric Field (E) <i class="fa-solid fa-circle-question help-icon" data-tooltip="Visualizes the electric field generated by charged bodies."></i></span>
						<input type="checkbox" id="showElecFieldBox">
						<div class="toggle-switch"></div>
					</label>
					<label class="toggle-row" style="margin-top:4px;">
						<span>Show Magnetic Field (B) <i class="fa-solid fa-circle-question help-icon" data-tooltip="Visualizes the magnetic field generated by bodies."></i></span>
						<input type="checkbox" id="showMagFieldBox">
						<div class="toggle-switch"></div>
					</label>
					<label class="toggle-row" style="margin-top:4px;">
						<span>Show Formula Field (E) <i class="fa-solid fa-circle-question help-icon" data-tooltip="Visualizes force fields defined by custom formulas."></i></span>
						<input type="checkbox" id="showFormulaFieldBox">
						<div class="toggle-switch"></div>
					</label>
				
					<div class="divider-sub"></div>
					
					<div class="control-row" style="margin-top: 8px;">
						<label>Field Grid Precision <i class="fa-solid fa-circle-question help-icon" data-tooltip="Sets the density of the field visualization grid."></i></label>
						<span id="fieldPrecVal" class="value-display"></span>
					</div>
					<input type="range" id="fieldPrecSlider" min="10" max="100" step="1">

					<div class="control-row hidden-content" style="margin-top: 4px;">
						<label>Field Intensity Scale <i class="fa-solid fa-circle-question help-icon" data-tooltip="Adjusts field vector length sensitivity to field intensity."></i></label>
						<span id="fieldScaleVal" class="value-display"></span>
					</div>
					<input type="range" id="fieldScaleSlider" class="hidden-content" min="1" max="300" step="1">

					<div class="control-row" style="margin-top: 8px;">
						<label>Grid Precision <i class="fa-solid fa-circle-question help-icon" data-tooltip="Detail level of the spacetime grid."></i></label>
						<span id="gridPrecVal" class="value-display"></span>
					</div>
					<input type="range" id="gridPrecSlider" min="1" max="100" step="1">

					<div class="control-row" style="margin-top: 4px;">
						<label>Spacetime Distortion <i class="fa-solid fa-circle-question help-icon" data-tooltip="Intensity of spacetime grid distortion by massive bodies."></i></label>
						<span id="gridDistVal" class="value-display"></span>
					</div>
					<input type="range" id="gridDistSlider" min="0" max="5" step="0.01">

					<div class="control-row" style="margin-top: 4px;">
						<label>Min Def. Dist <i class="fa-solid fa-circle-question help-icon" data-tooltip="Minimum distance for distortion calculation, avoids singularities."></i></label>
						<span id="gridMinDistVal" class="value-display"></span>
					</div>
					<input type="range" id="gridMinDistSlider" min="0.1" max="50" step="0.1">
				</div>
			</div>
			
			<div class="divider"></div>

			<div class="section-header toggle-header" id="fieldDefHeader">
				<span>Field Definition</span>
				<button id="toggleFieldDefBtn" class="btn-icon"><i class="fa-solid fa-chevron-down"></i></button>
			</div>

			<div id="fieldDefContent">
				<div id="fieldsListContainer" style="margin-bottom: 8px;">
				</div>
				<button id="addFieldBtn" class="btn secondary"><i class="fa-solid fa-plus"></i> Add Formula Field</button>
			</div>
			
			<div class="divider"></div>

			<div class="control-section collapsed-section" id="injectionSection">
				<div class="section-header toggle-header">
					<span>Injection parameters</span>
					<button id="toggleInjectionBtn" class="btn-icon"><i class="fa-solid fa-chevron-down"></i></button>
				</div>
				
				<div id="injectionContent">
					<div class="grid-2-col">
						<div class="input-wrapper" style="grid-column: span 3;">
							<label>Preset Object <i class="fa-solid fa-circle-question help-icon" data-tooltip="Selects a predefined object type with realistic physical parameters."></i></label>
							<select id="presetSelect" style="width:100%; padding:6px; background:var(--input-bg); border:1px solid var(--input-border); color:var(--text-primary); border-radius:3px; font-family:var(--font-ui); font-size:11px; outline:none;">
								<option value="">Custom</option>
							</select>
						</div>
						<div class="input-wrapper"><label>Mass <i class="fa-solid fa-circle-question help-icon" data-tooltip="Body mass. Drag label to adjust (Shift: precise, Ctrl: fast). Set to -1 for a fixed body."></i></label><input type="text" id="newMass"></div>
						<div class="input-wrapper"><label>Radius <i class="fa-solid fa-circle-question help-icon" data-tooltip="Body radius for collisions."></i></label><input type="text" id="newRadius"></div>
						<div class="input-wrapper"><label>Restit. Coeff. <i class="fa-solid fa-circle-question help-icon" data-tooltip="Collision elasticity (0=perfectly inelastic, 1=perfectly elastic)."></i></label><input type="text" id="newRestitution" min="0" max="1" step="0.01"></div>
						<div class="input-wrapper"><label>Position X <i class="fa-solid fa-circle-question help-icon" data-tooltip="Initial X coordinate."></i></label><input type="text" id="newX"></div>
						<div class="input-wrapper"><label>Position Y <i class="fa-solid fa-circle-question help-icon" data-tooltip="Initial Y coordinate."></i></label><input type="text" id="newY"></div>
						<div class="input-wrapper"><label>Charge (e) <i class="fa-solid fa-circle-question help-icon" data-tooltip="Body electric charge."></i></label><input type="text" id="newCharge"></div>
						<div class="input-wrapper"><label>Velocity X <i class="fa-solid fa-circle-question help-icon" data-tooltip="Initial velocity on X axis."></i></label><input type="text" id="newVX"></div>
						<div class="input-wrapper"><label>Velocity Y <i class="fa-solid fa-circle-question help-icon" data-tooltip="Initial velocity on Y axis."></i></label><input type="text" id="newVY"></div>
						<div class="input-wrapper"><label>Mag. Moment <i class="fa-solid fa-circle-question help-icon" data-tooltip="Body magnetic moment."></i></label><input type="text" id="newMagMoment"></div>
						<div class="input-wrapper"><label>Acc X <i class="fa-solid fa-circle-question help-icon" data-tooltip="Constant acceleration applied on X axis."></i></label><input type="text" id="newAX"></div>
						<div class="input-wrapper"><label>Acc Y <i class="fa-solid fa-circle-question help-icon" data-tooltip="Constant acceleration applied on Y axis."></i></label><input type="text" id="newAY"></div>
						<div class="input-wrapper"><label>Rot. Speed <i class="fa-solid fa-circle-question help-icon" data-tooltip="Body rotation speed."></i></label><input type="text" id="newRotationSpeed"></div>
						<div class="input-wrapper"><label>Temp. <i class="fa-solid fa-circle-question help-icon" data-tooltip="Body temperature (currently visual only)."></i></label><input type="text" id="newTemperature"></div>
						<div class="input-wrapper"><label>Young's Mod. <i class="fa-solid fa-circle-question help-icon" data-tooltip="Material Young's modulus, affects repulsion force during collisions."></i></label><input type="text" id="newYoungModulus"></div>
						<div class="input-wrapper"><label>Friction Coeff. <i class="fa-solid fa-circle-question help-icon" data-tooltip="Friction coefficient during collisions."></i></label><input type="text" id="newFriction" min="0" max="2" step="0.01"></div>
						<div class="input-wrapper"><label>Lifetime (ticks) <i class="fa-solid fa-circle-question help-icon" data-tooltip="Body lifetime in simulation 'ticks'. -1 for infinite."></i></label><input type="text" id="newLifetime" min="-1" step="1"></div>
					</div>
					
					<div class="divider-sub"></div>
					
					<div class="input-wrapper" style="margin-top:5px;">
						<button id="randomizeBtn" class="btn secondary"><i class="fa-solid fa-dice"></i> Random</button>
						<button id="addBodyBtn" class="btn action"><i class="fa-solid fa-plus"></i> Inject</button>
					</div>
					
					<div class="divider-sub"></div>
					
					<div class="input-wrapper">
						<label>Global Preset <i class="fa-solid fa-circle-question help-icon" data-tooltip="Loads a complete simulation configuration (bodies, zones, parameters)."></i></label>
						<div style="display:flex; gap:5px;">
							<select id="simPresetSelect" style="flex:1; padding:6px; background:var(--input-bg); border:1px solid var(--input-border); color:var(--text-primary); border-radius:3px; outline:none; font-family:var(--font-ui); font-size:11px;">
							</select>
							<button id="loadSimPresetBtn" class="btn secondary" style="width:auto;" title="Load Preset"><i class="fa-solid fa-upload"></i></button>
						</div>
					</div>
				</div>
			</div>

			<div class="divider"></div>

			<div class="control-section">
				<div class="section-header toggle-header" id="bodiesHeader">
					<span>Active bodies <span id="bodyCount">0</span></span>
					<button id="toggleBodiesBtn" class="btn-icon"><i class="fa-solid fa-chevron-down"></i></button>
				</div>
				<div id="bodySortContainer" style="margin-bottom: 8px; display: flex; gap: 5px;"></div>
				<div id="bodiesListContainer">
				</div>
			</div>

		</div>
	</div>

	<div id="toolsPanel" class="collapsed">
		<div id="toolsHeader">
			<button id="toggleToolsBtn"><i class="fa-solid fa-plus"></i></button>
			<span class="app-title"><i class="fa-solid fa-toolbox"></i> Tools</span>
		</div>
		
		<div id="toolsContent">
			<div class="control-section">
				<div class="section-header">Global Actions</div>
				<div class="grid-2-col">
					<button id="zeroVelBtn" class="btn secondary" title="Set all velocities to zero">
						<i class="fa-solid fa-stop"></i> Stop
					</button>
					<button id="reverseVelBtn" class="btn secondary" title="Reverse time flow">
						<i class="fa-solid fa-backward"></i> Reverse
					</button>
					<button id="killRotBtn" class="btn secondary" title="Reset angular velocity to zero">
						<i class="fa-solid fa-arrows-spin"></i> No Spin
					</button>
					<button id="snapBtn" class="btn secondary" title="Align bodies to grid (50px)">
						<i class="fa-solid fa-border-all"></i> Snap
					</button>
					<button id="scatterBtn" class="btn secondary" title="Randomize positions in view">
						<i class="fa-solid fa-shuffle"></i> Scatter
					</button>
					<button id="equalMassBtn" class="btn secondary" title="Set all masses to average">
						<i class="fa-solid fa-scale-balanced"></i> Equalize
					</button>
					<button id="cullBtn" class="btn danger" style="grid-column: span 3;" title="Remove all bodies outside the current camera view">
						<i class="fa-solid fa-trash-can"></i> Cull Outside View
					</button>
				</div>
			</div>
			
			<div class="control-section">
				<div class="section-header">Periodic Zones</div>
				<button id="toggleZoneDrawBtn" class="btn secondary">
					<i class="fa-solid fa-pen-ruler"></i> Draw Zone (Off)
				</button>
				
				<div id="periodicZonesCollapsible" style="display: none;">
					<div class="divider-sub"></div>
					<div class="section-header toggle-header" id="periodicZonesListHeader">
						<span>Defined Zones <span id="periodicZoneListCount">0</span></span>
						<button id="togglePeriodicZonesListBtn" class="btn-icon"><i class="fa-solid fa-chevron-down"></i></button>
					</div>
					<div id="zonesListContainer" style="display: flex; flex-direction: column; gap: 8px;">
					</div>
				</div>
			</div>
			
			<div class="control-section">
				<div class="section-header">Viscosity Zones</div>
				<button id="toggleViscosityZoneBtn" class="btn secondary">
					<i class="fa-solid fa-water"></i> Draw Viscosity (Off)
				</button>
				
				<div id="viscosityZonesCollapsible" style="display: none;">
					<div class="divider-sub"></div>
					<div class="section-header toggle-header" id="viscosityZonesListHeader">
						<span>Defined Zones <span id="viscosityZoneListCount">0</span></span>
						<button id="toggleViscosityZonesListBtn" class="btn-icon"><i class="fa-solid fa-chevron-down"></i></button>
					</div>
					<div id="viscosityZonesListContainer" style="display: flex; flex-direction: column; gap: 8px;">
					</div>
				</div>
			</div>
			
			<div class="control-section">
				<div class="section-header">Elastic Bonds</div>
				<button id="toggleBondToolBtn" class="btn secondary">
					<i class="fa-solid fa-link"></i> Link Bodies (Off)
				</button>
				
				<div id="bondsCollapsible" style="display: none;">
					<div class="divider-sub"></div>
					<div class="section-header toggle-header" id="bondsListHeader">
						<span>Defined Bonds <span id="bondListCount">0</span></span>
						<button id="toggleBondsListBtn" class="btn-icon"><i class="fa-solid fa-chevron-down"></i></button>
					</div>
					<div id="bondsListContainer" style="display: flex; flex-direction: column; gap: 8px;">
					</div>
				</div>
			</div>
			
			<div class="control-section">
				<div class="section-header">Solid Barriers</div>
				<button id="toggleBarrierToolBtn" class="btn secondary">
					<i class="fa-solid fa-road"></i> Draw Barrier (Off)
				</button>
				
				<div id="barriersCollapsible" style="display: none;">
					<div class="divider-sub"></div>
					<div class="section-header toggle-header" id="barriersListHeader">
						<span>Defined Barriers <span id="barrierListCount">0</span></span>
						<button id="toggleBarriersListBtn" class="btn-icon"><i class="fa-solid fa-chevron-down"></i></button>
					</div>
					<div id="barriersListContainer" style="display: flex; flex-direction: column; gap: 8px;">
					</div>
				</div>
			</div>
			
			<div class="control-section">
				<div class="section-header">Field Zones</div>
				<button id="toggleFieldZoneToolBtn" class="btn secondary">
					<i class="fa-solid fa-arrow-down"></i> Draw Field (Off)
				</button>
				
				<div id="fieldZonesCollapsible" style="display: none;">
					<div class="divider-sub"></div>
					<div class="section-header toggle-header" id="fieldZonesListHeader">
						<span>Defined Zones <span id="fieldZoneListCount">0</span></span>
						<button id="toggleFieldZonesListBtn" class="btn-icon"><i class="fa-solid fa-chevron-down"></i></button>
					</div>
					<div id="fieldZonesListContainer" style="display: flex; flex-direction: column; gap: 8px;">
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<script src="simulation.js"></script>
	<script src="rendering.js"></script>
	<script src="interface.js"></script>
	<script src="presets.js"></script>
	<script>
		if ('serviceWorker' in navigator) {
			navigator.serviceWorker.register('sw.js');
		}
	</script>
</body>
</html>